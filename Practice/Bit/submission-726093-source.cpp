#include<bits/stdc++.h>
using namespace std;const int M=10005;int dp[M][M],a[M];int32_t main(){int n,INV;cin>>n;for(int i=1;i<=n;i++)scanf("%d",a+i);for(int i=1;i<=n;i++){dp[i][n+1]=dp[i-1][n+1];for(int j=1;j<i;j++)if(a[i]<a[j])dp[i][n+1]++;}for(int i=n;i;i--){dp[0][i]=dp[0][i+1];for(int j=i+1;j<=n;j++)if(a[i]>a[j])dp[0][i]++;}for(int i=1;i<=n;i++)for(int j=n;j>i;j--){dp[i][j]=dp[i-1][j]+dp[i][j+1]-dp[i-1][j+1];if(a[j]<a[i])dp[i][j]++;}INV=dp[n][n+1];int q;cin>>q;while(q--){int typ,l,r;scanf("%d%d%d",&typ,&l,&r);l++,r++;if(r<l)swap(l,r);int ans=INV;if(!typ){for(int p=l+1;p<r;p++){if(a[l]>a[p])ans--;if(a[l]<a[p])ans++;if(a[r]>a[p])ans++;if(a[r]<a[p])ans--;}if(a[r]>a[l])ans++;if(a[l]>a[r])ans--;}else ans=dp[l-1][r+1];printf("%d\n",ans);}return 0;}